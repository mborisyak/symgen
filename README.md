# SymGen

SymGen is a fast interpreter and generator of symbolic expressions. It uses mixed stack-memory machines for evaluation
and stochastic context-free grammars for generating symbolic expressions.

## Why?

For sampling large datasets of "low-complexity" regression and classification tasks,
generated by symbolic expressions of limited size.

## How fast?

SymGen generates C code for both evaluation and generation machines, compiles it with gcc and then imports the resulting
shared library into the Python interpreter. While there is a certain overhead associated with execution of the stack
machine, the execution speed is closer to C code than to pure Python alternatives.

For example, evaluating an equivalent of `np.sum(x[:n] * x[n:])` on 64 points with `n=32` 16000 times yields:
```
SymGen: 0.235 seconds
eval: 5.977 seconds
eval (vectorized): 0.565 seconds
NumPy: 0.049 seconds
Binary (estimated): 0.025 seconds
```
where:
- `eval` executes pre-compiled Python expression `x[0] * x[32] + x[1] * x[33] + ...` for each point;
- `eval (vectorized)` vectorizes operations with numpy: `x[:, 0] * x[:, 32] + x[:, 1] * x[:, 33] + ...`;
- `numpy`: `np.sum(x[:, :, :n] * x[:, :, n:], axis=2)`;
- `Binary` is estimated for a 4 GFlops core (with fully inline code, e.g., fully unrolled loops).

Note, that numpy gains a large speed-up due to repeating operations. Performance on arbitrary expressions is
shown by the vectorized `eval`.

## Why stack machines?

Stack machines are nicely suited for symbolic expressions. Most of the mathematical expressions can be
effortlessly converted into reverse Polish notation and executed on a stack machine: `(x + y) * z -> x y + z *`.
Naturally, reverse Polish notation is easy and intuitive to work with for generating random expressions.

While it is also possible to convert an expression into the format of RAM / register machines, they come with an additional
hurdle of keeping track of memory / registers: one either has to compile reverse Polish notations into RAM / register machine code
or directly generate such code.



